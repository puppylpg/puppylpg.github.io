---
layout: post
title: "Unicodeå’ŒUTF"
date: 2019-12-15 16:48:21 +0800
categories: Unicode UTF Java
tags: Unicode UTF Java
---

Unicodeå°±æ˜¯ä¸€ä¸ªè¶…å¤§å·å­—ç¬¦é›†åˆï¼Œæ—¨åœ¨å°†ä¸–ç•Œä¸Šæ‰€æœ‰ç°å­˜çš„ã€æ›¾æœ‰çš„ç¬¦å·ï¼ˆæ–‡å­—ã€æ•°å­¦ã€éŸ³ä¹ç­‰æ‰€æœ‰ç¬¦å·ï¼‰å›Šæ‹¬å…¶ä¸­ã€‚**å®ƒåƒä¸€ä¸ªæ¥å£ï¼Œåªæ˜¯è§„å®šäº†æ‰€æœ‰å­—ç¬¦çš„ç¼–å·ï¼Œå…·ä½“è¿™äº›å­—ç¬¦åœ¨ä½¿ç”¨ã€å­˜å‚¨çš„æ—¶å€™ç”¨å­—èŠ‚æ€ä¹ˆè¡¨ç¤ºï¼Œå–å†³äºå„ä¸ªå­—ç¬¦é›†çš„å®ç°**ã€‚

1. Table of Contents, ordered
{:toc}

# Unicode
Unicodeä¸ºæ¯ä¸ªå­—ç¬¦èµ‹äºˆä¸€ä¸ªç‰¹å®šçš„ç¼–å·ï¼ˆ**code pointï¼Œç ç‚¹**ï¼‰ã€‚è¿™äº›ç ç‚¹ä¸€èˆ¬ç”¨åå…­è¿›åˆ¶è¿›è¡Œç¼–å·ï¼ˆè€Œä¸æ˜¯äººç±»æ›´ç†Ÿæ‚‰çš„åè¿›åˆ¶ï¼‰ï¼Œä½¿ç”¨â€œU+â€ä½œä¸ºå‰ç¼€ã€‚æ¯”å¦‚
- ç¬¬0x41ä¸ªå­—ç¬¦ï¼ˆæˆ–è€…ç”¨äººç±»æ›´ç†Ÿæ‚‰çš„åè¿›åˆ¶æ¥è¯´ï¼Œå°±æ˜¯ç¬¬65å·å­—ç¬¦ï¼‰ï¼Œå°±æ˜¯[å¤§å†™å­—æ¯A](http://unicode.org/cldr/utility/character.jsp?a=A)ã€‚
- â€œ[çš®](http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=%E7%9A%AE&mode=char)â€çš„ç ç‚¹æ˜¯U+76AEï¼Œæ˜¯ç¬¬0x76aeä¸ªå­—ç¬¦ï¼ˆæˆ–è€…è¯´ç¬¬30382ä¸ªï¼‰ã€‚

**è‡³äºæ€ä¹ˆç”¨å­—èŠ‚å»è¡¨ç¤ºè¿™äº›å­—ç¬¦ï¼Œæ˜¯å„ä¸ªå­—ç¬¦é›†è‡ªå·±å†…éƒ¨çš„äº‹æƒ…ï¼Œå’ŒUnicodeæ— å…³ã€‚**

> ä»è¿™ä¸ªå±‚é¢æ¥è®²ï¼Œå¯ä»¥å°†Unicodeç†è§£ä¸ºJavaçš„æ¥å£ï¼Œæ‰€æœ‰çš„å…·ä½“ç¼–ç å½¢å¼æ˜¯å®ƒçš„å®ç°ç±»ã€‚

## é¢æ¿plane

> Unicodeé¢æ¿çš„è‹±æ–‡æ˜¯planeï¼Œè€Œépanelã€‚

- Unicodeæ¯ä¸ªé¢æ¿æœ‰65536ï¼ˆ0xFFFFï¼‰ä¸ªç¼–ç ç‚¹ï¼Œ**æ­£å¥½èƒ½ç”¨ä¸¤ä¸ªbyteè¡¨ç¤ºä¸€ä¸ªplane**ï¼›
- Unicodeå…±æœ‰17ä¸ªé¢æ¿ï¼Œç¼–å·ä¸º0-16ï¼Œæ€»åŒºé—´ä¸ºU+10FFFFï¼ˆåå…­è¿›åˆ¶è¡¨ç¤ºï¼Œ17ä¸ªFFFFï¼‰ã€‚ï¼ˆæ‰€ä»¥**å››ä¸ªå­—èŠ‚è‚¯å®šå¯ä»¥è¡¨ç¤ºæ•´ä¸ªUnicode**ï¼‰ï¼›
- Unicodeçš„**æœ€åä¸€ä¸ªç ç‚¹ä¸º`U+10FFFF`**ï¼›
- é¢æ¿0è¢«ç§°ä¸ºBasic Multilingual Planeï¼ˆ**BMPï¼ŒåŸºæœ¬å¤šè¯­è¨€é¢æ¿**ï¼‰ï¼ŒåŒ…å«äº†æœ€ç»å¸¸ä½¿ç”¨çš„å­—ç¬¦ã€‚æ¢å¥è¯è¯´Unicodeçš„å‰65536ä¸ªç ç‚¹å›Šæ‹¬äº†å½“ä»Šå‡ ä¹æ‰€æœ‰å¸¸ç”¨å­—ç¬¦ï¼›
- 1-16å·é¢æ¿è¢«ç§°ä¸º**è¡¥å……é¢æ¿supplementary planes**ï¼›
- CJKä½œä¸ºä¸­æ—¥éŸ©å­—ç¬¦ï¼Œæ˜¾ç„¶ä¹Ÿåœ¨BMPä¸­ï¼›

æŸ¥çœ‹Unicode PlaneåŠå†…å®¹ï¼š
- https://en.wikipedia.org/wiki/Plane_(Unicode)#Overview
- https://en.wikibooks.org/wiki/Unicode/Character_reference/7000-7FFF

## BMP
![BMPå­—ç¬¦ç»„æˆ](https://upload.wikimedia.org/wikipedia/commons/8/8e/Roadmap_to_Unicode_BMP.svg)

å¯çœ‹åˆ°CJKå äº†BMPçš„ç»å¤§éƒ¨åˆ†ã€‚

å¦‚æœä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼Œå¯ä»¥å®Œæ•´è¡¨ç¤ºä¸€ä¸ªé¢æ¿ã€‚ä¸€ä¸ªå­—èŠ‚èƒ½è¡¨ç¤º256ä¸ªå­—ç¬¦ï¼Œä¸¤ä¸ªå­—èŠ‚æ˜¯`256*256`ï¼Œå°†BMPåˆ†æˆ256ä¸ªå°æ ¼ï¼Œä¸€ä¸ªå°æ ¼å°±æ˜¯ä¸€å­—èŠ‚èƒ½è¡¨ç¤ºçš„å­—ç¬¦æ•°ã€‚æ‰€ä»¥ **ASCIIç ï¼ˆ7bitï¼Œ128ä¸ªï¼‰å…¨éƒ½åŒ…å«åœ¨ç¬¬ä¸€å°æ ¼é‡Œ**ã€‚

> ä¸€å¼€å§‹ï¼ŒUnicodeå°±åªæœ‰ä¸€ä¸ªé¢æ¿ï¼Œä¹Ÿå°±æ˜¯0å·é¢æ¿ï¼Œæœ€å¤šè¡¨ç¤º256*256=65536ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨ç»Ÿä¸€çš„16bitè¿›è¡Œç¼–ç ã€‚ï¼ˆ16bitæ­£å¥½è¡¨ç¤ºå®Œä¸€æ•´ä¸ªé¢æ¿ï¼‰**äººä»¬è¯¯ä»¥ä¸ºä¸€ä¸ªé¢æ¿ç©ºé—´å¤Ÿäº†ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†åæ¥UTF-16çš„å°´å°¬å­˜åœ¨**ã€‚

# å­—ç¬¦ç¼–ç 
æ‰€æœ‰çš„å­—ç¬¦éƒ½èµ‹äºˆäº†ç¼–å·ï¼Œä»U+0000åˆ°U+10FFFFã€‚ä½†æ˜¯åœ¨å­—èŠ‚è¡¨ç¤ºå±‚é¢ä¸Šï¼Œè¿™äº›å­—ç¬¦éƒ½æ˜¯æ€ä¹ˆç”¨å­—èŠ‚è¡¨ç¤ºçš„å‘¢ï¼Ÿè¿™å°±æ˜¯å­—ç¬¦é›†è¦åšçš„äº‹æƒ…ã€‚æ¯”å¦‚UTF-8 Encodingã€‚

## å®šé•¿ vs. å˜é•¿
é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¤šå­—ç¬¦é›†ï¼Ÿéƒ½ä½¿ç”¨åŒä¸€ç§ä¸è¡Œå—ï¼Ÿ

æ¯”å¦‚ï¼Œæœ€ç®€å•çš„ï¼ŒUnicodeç©ºé—´ä¸‹0x10FFFFä¸ªå­—ç¬¦ï¼Œä½¿ç”¨21bitå»è¡¨ç¤ºæ˜¯ç»°ç»°æœ‰ä½™çš„ã€‚å‡‘ä¸ªæ•´ï¼Œä½¿ç”¨å››å­—èŠ‚ï¼ˆ32bitï¼‰ç¼–ç Unicodeå®Œå…¨å¤Ÿï¼šæ¯ä¸€ä¸ªå­—ç¬¦ï¼Œéƒ½ç”¨å››ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºã€‚ï¼ˆæ˜¯è°“**å®šé•¿ç¼–ç **ï¼‰

ä½†æ˜¯æ€è·¯ä¸Šçš„ç®€å•é€šå¸¸æ„å‘³ç€ä½¿ç”¨ä¸Šçš„ä»£ä»·ã€‚æ¯ä¸ªå­—ç¬¦éƒ½ç”¨32bitè¡¨ç¤ºï¼Œæ˜¾ç„¶æ— è®ºç¡¬ç›˜ã€å†…å­˜ï¼Œè¿˜æ˜¯ç½‘ç»œï¼Œåœ¨ä¼ è¾“textçš„æ—¶å€™ï¼Œä½¿ç”¨çš„byteä¼šæå¤§åœ°è†¨èƒ€ã€‚

é‚£å’‹åŠå˜›ï¼Ÿä½¿ç”¨å°äºå››ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œåˆç¼–ç ä¸ä¸‹è¿™ä¹ˆå¤šå­—ç¬¦ã€‚

æ‰€ä»¥**å˜é•¿ç¼–ç **çš„ä½œç”¨å°±ä½“ç°å‡ºæ¥ï¼šæ¯”å¦‚ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚çš„å‰7bitè¡¨ç¤ºæœ€å¸¸ç”¨çš„è‹±æ–‡å­—ç¬¦ï¼ˆASCIIï¼‰ï¼Œç„¶åä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºåç»­çš„æ‹‰ä¸å­—ç¬¦ï¼Œå†æ¥ç€ç”¨ä¸‰ä¸ªå­—ç¬¦è¡¨ç¤ºUnicodeç©ºé—´ä¸­ç´§éšå…¶åçš„CJKç­‰ç­‰ã€‚

è¿™æ ·ä¸€æ¥ï¼Œ**é«˜é¢‘å­—ç¬¦ç”¨å¾ˆå°‘çš„å­—èŠ‚æ•°è¡¨ç¤ºï¼ˆegï¼š1 byteï¼‰ï¼Œä½é¢‘å­—ç¬¦ç”¨å¾ˆå¤šçš„å­—èŠ‚æ•°è¡¨ç¤ºï¼ˆegï¼š4 byteï¼‰ï¼Œä½†æ˜¯æ€»ä½“ä½¿ç”¨ä¸Šï¼Œç”±äºä½é¢‘å­—ç¬¦å¾ˆå°‘å‡ºç°ï¼Œç›¸å½“äºç”¨äº†ç›¸å¯¹å°‘çš„å­—èŠ‚æ¥è¡¨ç¤ºäº†å½“å‰ä½¿ç”¨çš„å­—ç¬¦**ã€‚

> å®é™…ä¸ŠUTF-8ä¹Ÿå¹¶æ²¡æœ‰è¶…è¿‡å››ä¸ªå­—èŠ‚ï¼Œå› ä¸ºUnicode 17ä¸ªé¢æ¿æœ¬æ¥ä¹Ÿç”¨ä¸å®Œå››ä¸ªå­—èŠ‚ï¼Œ21bitå°±å¤Ÿäº†ã€‚æ‰€ä»¥è™½ç„¶ä½¿ç”¨äº†å˜é•¿ç¼–ç ï¼ŒUTF-8è¡¨ç¤ºå­—ç¬¦çš„æœ€é•¿å­—èŠ‚æ•°ä¹Ÿæ²¡è¶…è¿‡4ã€‚

å˜é•¿çš„ä¼˜ç‚¹ï¼š
- å¥½å¤„å½“ç„¶æ˜¯åœ¨èƒ½è¡¨ç¤ºæ‰€æœ‰å­—ç¬¦çš„åŒæ—¶ï¼Œæœ€å¤§ç¨‹åº¦åœ°èŠ‚çœç©ºé—´ï¼›

å˜é•¿çš„ç¼ºç‚¹ï¼š
- ç¼ºç‚¹è‡ªç„¶å°±æ˜¯è¿™ä¹ˆä¸€æé€»è¾‘ä¸Šå°±å¤æ‚äº†ã€‚å˜é•¿ç¼–ç æ¯”å®šé•¿ç¼–ç é€»è¾‘ä¸Šæ›´å¤æ‚ï¼Œè¿™æ˜¯è‚¯å®šçš„ï¼›
- å¤„ç†é€»è¾‘å¤æ‚äº†ï¼Œ**æ¯”å¦‚æ— æ³•ç›´æ¥å®šä½åˆ°ç¬¬kä¸ªå­—ç¬¦çš„å­—èŠ‚æ•°æ˜¯å“ªäº›ï¼Œåªèƒ½ä»å¤´å¼€å§‹æ•°**ã€‚æ€»ä½“é€Ÿåº¦ä¸Šç›¸åº”ä¼šæ…¢ä¸€ç‚¹ï¼Œè¿™ä¹Ÿæ˜¯æ— æ³•é¿å…çš„ã€‚

å®šé•¿çš„ä¼˜ç‚¹
- UTF-32çš„å¥½å¤„å°±æ˜¯ç®€å•å‘€ï¼ä¸€ä¸ªå­—ç¬¦ä¸å››ä¸ªå­—èŠ‚å›ºå®šå¯¹åº”ï¼æ‰€ä»¥å¯ä»¥ç”¨å®ƒæ¥åš**ä¸€äº›ä¸´æ—¶çš„å†…éƒ¨å¤„ç†é€»è¾‘**ï¼Œæ¯”å¦‚æ£€æŸ¥å­—ç¬¦ä¸²é‡Œçš„ç ç‚¹ç­‰ï¼Œä½†æ˜¯æœ€ç»ˆä¿å­˜textçš„æ—¶å€™è‚¯å®šä¸ä¼šæ‹¿å®ƒæ¥å­˜å‚¨çš„ã€‚

æ‰€ä»¥å˜é•¿ç¼–ç å’Œå®šé•¿ç¼–ç ï¼Œå„æœ‰åƒç§‹ã€‚è€Œä¸”**ä»å®šä¹‰æ¥çœ‹ï¼Œå®šé•¿ç¼–ç åªæœ‰ä¸€ä¸ªï¼Œå˜é•¿ç¼–ç å´æœ‰ä¸åŒçš„å˜é•¿æ–¹å¼**ã€‚æ—¢ç„¶å˜é•¿çš„ç›®çš„æ˜¯é«˜æ•ˆå­˜å‚¨ï¼Œé‚£ä¹ˆä¸åŒçš„å˜é•¿å­—ç¬¦é›†æ˜¯æœ‰ä¼˜åŠ£ä¹‹åˆ†çš„ï¼Œæ— æ³•åšåˆ°é«˜æ•ˆå­˜å‚¨çš„å­—ç¬¦é›†ï¼Œæ²¡æœ‰å­˜åœ¨çš„å¿…è¦ã€‚

> UTF-16ï¼šæˆ‘åº”è¯¥åœ¨è½¦åº•ï¼Œä¸åº”è¯¥åœ¨è½¦é‡Œ /(ã„’oã„’)/~~

## UTF-8: use 8-bit code unit
åç§°ç”±æ¥ï¼š**Unicode Transformation Format-8bitï¼ˆUnicodeè½¬åŒ–æ ¼å¼-8bitï¼ŒUTF-8ï¼‰**ï¼Œæ˜¯**ç”¨8bitä½œä¸ºä¸€ä¸ªåŸºæœ¬å•å…ƒ**ï¼Œæ¥å®ç°ä¸€ä¸ªUnicodeå­—ç¬¦é›†ã€‚

> Ken Thompsonå‘æ˜çš„ï¼Œ**ä½¿ç”¨1-4ä¸ªbyteï¼ˆ8bitï¼‰è¡¨ç¤ºUnicodeçš„ä¸€ä¸ªå­—ç¬¦**ã€‚

### è¡¨ç¤ºæ–¹æ³•

bytes used |	bits used |	First code point |	Last code point | Byte 4 |	Byte 3 |	Byte 2 |	Byte 1
--|--|--|--|--|--|--|--|
1 |	7 |	U+0000 |	U+007F | | | |	0xxxxxxx			
2 |	11 |	U+0080 |	U+07FF | | |	110xxxxx |	10xxxxxx		
3 |	16 |	U+0800 |	U+FFFF | |	1110xxxx |	10xxxxxx |	10xxxxxx	
4 |	21 |	U+10000 |	U+10FFFF |	11110xxx |	10xxxxxx |	10xxxxxx |	10xxxxxx


- **`ASCII`**ï¼šå‰128(0x7F)ä¸ªå­—ç¬¦ï¼ˆ7bitï¼‰ä½¿ç”¨ä¸€ä¸ªbyteæå®šï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ä¸º`0xxxxxxx`ï¼›
- **æ‹‰ä¸è¯­ç³»å­—æ¯ï¼ˆå¸Œè…Šè¯­ã€é˜¿æ‹‰ä¼¯ã€å¤å™åˆ©äºšç­‰ï¼‰**ï¼šæ¥ä¸‹æ¥çš„ä¸€å¨ï¼ˆ1920ä¸ªå­—ç¬¦ï¼‰ä½¿ç”¨ä¸¤ä¸ªbyteï¼Œå…±è®¡11bitæå®šï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ä¸º`110xxxxx	10xxxxxx`ï¼›
- **ä¸­æ—¥éŸ©CJKæ–‡å­—**ï¼š
- **ä¸å¸¸ç”¨CJKã€æ•°å­¦ç¬¦å·ã€å†å²ç¬¦å·ã€emoji**ï¼š

> è‹±æ–‡å­—ç¬¦å’ŒCJKå­—ç¬¦è™½ç„¶éƒ½åœ¨BMPä¸­ï¼Œä½†æ˜¯åœ¨UTF-8ç¼–ç ä¸­è‹±æ–‡å­—ç¬¦æ˜¯å•å­—èŠ‚è¡¨ç¤ºï¼Œç¼–åˆ°CJKæ—¶å·²ç»è¦ä½¿ç”¨ä¸‰å­—èŠ‚ç¼–ç ä¸€ä¸ªå­—ç¬¦äº†ï¼æœ€ç»ˆ**UTF-8ç”¨äº†1-3ä¸ªbyteæ‰å°†BMPç¼–ç å®Œæ¯•ï¼**

å¯ä»¥çœ‹åˆ°ï¼Œ**UTF-8æ˜¯å…¼å®¹ASCIIç¼–ç çš„ï¼è¿™æ˜¯å®ƒçš„ä¸€å¤§ä¼˜åŠ¿ï¼**

### ç¤ºä¾‹
å¦‚æœç”¨UTF-8è¡¨ç¤ºâ€œçš®â€ï¼Œä¼šè¡¨ç¤ºä¸ºä¸‰ä¸ªå­—èŠ‚ï¼š11100111 10011010 10101110ï¼Œåå…­è¿›åˆ¶è¡¨ç¤ºä¸º0x E7 9A AEã€‚

> å¦‚æœç”¨UTF-16è¡¨ç¤ºå®ƒï¼Œä¼šè¡¨ç¤ºä¸ºä¸¤ä¸ªå­—èŠ‚ï¼š0x76 AEã€‚
>
> ä½†æ˜¯åªæ˜¯åœ¨â€œçš®â€ä¸ŠUTF-16æ¯”UTF-8çœç©ºé—´ï¼Œå¦‚æœè¡¨ç¤ºè‹±æ–‡ï¼ŒUTF-8ä¸€ä¸ªå­—èŠ‚å°±ç»°ç»°æœ‰ä½™äº†ï¼ŒUTF-16è¿˜æ˜¯å¾—2ä¸ªå­—èŠ‚ã€‚

### åº”ç”¨
UTF-8å·²ç»æ˜¯æœ€ä¸»æµçš„ç¼–ç ï¼Œä¸–ç•Œä¸Š90%+çš„ç½‘é¡µçš„ç¼–ç éƒ½æ˜¯UTF-8ã€‚

### å­—èŠ‚åº
**UTF-8ä½¿ç”¨å•å­—èŠ‚ä½œä¸ºç¼–ç çš„unitï¼Œæ‰€ä»¥ä¸å­˜åœ¨å­—èŠ‚åºé—®é¢˜**ã€‚

å› æ­¤ï¼ŒUTF-8å¯ä»¥æ²¡æœ‰BOMã€‚ä¸è¿‡UTF-8ä¹Ÿå¯ä»¥ä½¿ç”¨`0xEF,0xBB,0xBF`ä½œä¸ºå­—èŠ‚åºï¼Œä»…ä»…æ˜¯å®£å¸ƒï¼šâ€œæˆ‘æ˜¯UTF-8â€ï¼Œå¹¶æ²¡æœ‰å…¶ä»–ä»€ä¹ˆæ„ä¹‰ã€‚

UTF-16åˆ™ä¸ç„¶ï¼Œå¦‚æœæ²¡æœ‰BOMï¼Œå°±ä¸çŸ¥é“å­—èŠ‚ç©¶ç«Ÿè¯¥æ€ä¹ˆç¿»è¯‘äº†ã€‚

## ~~UTF-16~~: use 16-bit code unit
åŒç†ï¼ŒUTF-16å…¶å®å°±æ˜¯ä»¥16ä¸ªbitä½œä¸ºä¸€ä¸ªç¼–ç çš„åŸºæœ¬å•å…ƒï¼Œ16bitæ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸€ä¸ªå•å…ƒç¼–ç çš„å­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚ï¼Œä½¿ç”¨ä¸¤ä¸ªå•å…ƒç¼–ç çš„å­—ç¬¦å å››ä¸ªå­—èŠ‚ã€‚å­—èŠ‚æ•°ä¸€å®šæ˜¯2çš„æ•´å€æ•°ã€‚

**æ—¢ç„¶ä¸¤byteè¡¨ç¤ºä¸€ä¸ªå•å…ƒï¼Œé‚£ä¸¤ä¸ªbyteè°å…ˆè°åï¼Œå°±å¿…é¡»å¾—æå‰è¯´å¥½ï¼Œå¦åˆ™æ˜¯æ²¡åŠæ³•æ­£ç¡®ç¿»è¯‘å­—èŠ‚çš„**ã€‚

### å†å²
UTF-16çš„ç”±æ¥éœ€è¦è¿½æº¯ä¸€ä¸‹å†å²ã€‚

ä¸€å¼€å§‹ï¼Œå¤§å®¶å‡†å¤‡æä¸€ä¸ª**ç»Ÿä¸€å­—ç¬¦é›†ï¼ˆUniversal Character Set, UCSï¼‰**ï¼Œæ¥è¡¨ç¤ºæ‰€æœ‰è¯­è¨€ä¸­ä½¿ç”¨çš„å­—ç¬¦ã€‚å…¶å®å’ŒUnicodeä¸€ä¸ªç›®çš„ï¼Œåªä¸è¿‡æ²¡è®¾è®¡å¥½ï¼šä¸€å¼€å§‹å¤§å®¶å‡†å¤‡ç”¨ä¸ªç»Ÿä¸€çš„è§„èŒƒï¼Œ**æ‰€æœ‰å­—ç¬¦éƒ½ç”¨ä¸¤ä¸ªå­—èŠ‚ç¼–ç **ï¼Œè¿™æ ·ä¸€å…±å¯ä»¥ç¼–ç 2^16ä¸ªå­—ç¬¦ã€‚å…¶å®è¿™å°±æ˜¯Unicodeä¸­çš„ç¬¬0å·é¢æ¿BMPï¼ˆä¸Šé¢è¯´è¿‡ï¼Œä¸€ä¸ªé¢æ¿èƒ½ç”¨ä¸¤ä¸ªå­—èŠ‚ä¸€ä¸€å¯¹åº”è¡¨ç¤ºï¼‰ã€‚**è¿™æ ·çš„è¯ä¸–ç•Œä¸Šçš„é‚£ä¸ªå®šé•¿å­—ç¬¦é›†å°±æ˜¯UCS-2ï¼Œç ç‚¹ç©ºé—´ä¸º65536ã€‚**

ç„¶è€Œåæ¥å¤§å®¶å‘ç°65536è¿˜æ˜¯æœ‰äº›å¤ªå°äº†ï¼Œä¸–ç•Œä¸Šæ‰€æœ‰çš„ç¬¦å·åŠ èµ·æ¥è¶…å‡ºäº†è¿™ä¸ªèŒƒå›´ã€‚æ‰€ä»¥åæ¥å­—ç¬¦é›†æ‰©å……åˆ°Unicodeï¼Œä¸€å…±17å—é¢æ¿ï¼Œéœ€è¦`17*65536`çš„ç©ºé—´ã€‚

UCS-2å°¬ä½äº†ï¼Unicodeä½¿ç”¨äº†æ–°æ ‡å‡†UTF-8ã€UTF-16ã€UTF-32æ¥è¡¨ç¤ºæ–°çš„Unicodeç©ºé—´ï¼ŒUTF-16å°±æ˜¯å…¼å®¹UCS-2çš„æ–°æ–¹æ¡ˆï¼Œç„¶è€Œè¿™ä¸ªæ–¹æ¡ˆï¼š
- **æ—¢ä¸å®šé•¿**ï¼ˆUTF-32ï¼‰
- **ä¹Ÿä¸é«˜æ•ˆ**ï¼ˆUTF-8ï¼‰
- **è¿˜ä¸å…¼å®¹ASCII**ï¼ˆUTF-8ï¼‰

**æ‰€ä»¥å®é™…ä¸Šæˆäº†ä¸€ä¸ªè¿›ä¸å¦‚UTF-8ï¼Œé€€ä¸å¦‚UTF-16çš„åƒåœ¾æ–¹æ¡ˆã€‚**

ä½†æ˜¯ï¼Œæ¯”è¾ƒè€çš„ç³»ç»Ÿæ¯”å¦‚Windowsã€Javaå½“å¹´éƒ½æ”¯æŒäº†UCS-2ã€‚å®šé•¿ç¼–ç å˜›ï¼Œè‚¯å®šæ˜¯è¦æ”¯æŒä¸€ä¸‹çš„ï¼Œè°æ‰¿æƒ³åæ¥å®ƒä¸å†æ˜¯å®šé•¿ç¼–ç äº†ï¼Œå‡çº§ä¸ºäº†å˜é•¿ç¼–ç ï¼**ä¸ºäº†å‘ä¸‹å…¼å®¹ï¼Œä»–ä»¬ä¹Ÿåªèƒ½å°†å…¶ï¼ˆUTF-16ï¼‰ç»§ç»­ä¿ç•™åœ¨ç³»ç»Ÿä¸­**ã€‚ä½†æ˜¯æ–°çš„æ“ä½œç³»ç»Ÿå’Œç¼–ç¨‹è¯­è¨€ï¼Œåè€Œèº²è¿‡ä¸€åŠ«ï¼Œ**ä¸€èˆ¬åªæ”¯æŒä¸¤å¥—å­—ç¬¦é›†ï¼šå˜é•¿çš„ç”¨UTF-8ï¼Œå®šé•¿çš„ç”¨UTF-32**ã€‚

> å‚è€ƒï¼š[Java ä¸ºä»€ä¹ˆä½¿ç”¨ UTF-16 è€Œä¸æ˜¯æ›´èŠ‚çœå†…å­˜çš„ UTF-8ï¼Ÿ](https://www.zhihu.com/question/308677093/answer/2748648048)

### ç¼–ç æ–¹å¼
UTF-16å’ŒUCS-2ä¸€æ ·ï¼Œä¹Ÿé‡‡ç”¨ä¸¤ä¸ªbyteä½œä¸ºä¸€ä¸ªç¼–ç çš„åŸºæœ¬å•å…ƒã€‚

UTF-16çš„ä½œä¸ºå˜é•¿ç¼–ç ï¼Œå˜é•¿çš„æ–¹å¼å’ŒUTF-8çš„æ€è·¯ä¸å¤ªä¸€æ ·ï¼š
- UTF-8æ˜¯å…ˆç”¨å•å­—èŠ‚ç¼–ç å­—ç¬¦ï¼Œç„¶åæ˜¯åŒå­—èŠ‚ï¼Œç„¶åä¸‰å­—èŠ‚ï¼Œæœ€åå››å­—èŠ‚ï¼›
- UTF-16æ˜¯ç”¨åŒå­—èŠ‚ç¼–ç å­—ç¬¦ï¼Œä½†æ˜¯ä¸¤ä¸ªbyteåªå¤Ÿç¼–ç ä¸€å—é¢æ¿ï¼Œ**æ‰€ä»¥UTF-16ç•™äº†ä¸€äº›ç¼–ç ç©ºé—´ä¸ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ï¼Œè€Œæ˜¯ç”¨æ¥ç»„åˆå‡ºåé¢çš„å­—ç¬¦**ã€‚å› æ­¤**å¯¹äºUTF-16æ¥è¯´ï¼Œè¡¥å……é¢æ¿ä¸Šçš„å­—ç¬¦éƒ½è¦ç”¨BMPä»£ç†åŒºåŸŸä¸­çš„ä¸¤ä¸ªç ç‚¹ç»„åˆèµ·æ¥è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯éœ€è¦ç”¨4byteæ¥è¡¨ç¤º**ï¼›

æ¯”å¦‚ï¼Œè¦ç¼–ç BMPä¸­çš„65536ä¸ªç ç‚¹ï¼Œæ­£å¥½å¯¹åº”2byteã€‚å¦‚æœUTF-16åªç”¨å‰65436ä¸ªç ç‚¹ç¼–ç å‰65436ä¸ªå­—ç¬¦ï¼Œå‰©ä¸‹çš„100ä¸ªç ç‚¹æ²¡æœ‰ç¼–ç å­—ç¬¦ï¼Œå°†è¿™äº›ç ç‚¹åˆ†ä¸ºå‰50ä¸ªå’Œå50ä¸ªï¼Œé‚£ä¹ˆâ€œå‰_åâ€ä¸€å…±å¯ä»¥ç»„åˆå‡º`50*50=2500`ä¸ªç ç‚¹ã€‚åªä¸è¿‡è¿™2500ä¸ªç ç‚¹éƒ½æ˜¯ç”±2ä¸ªunitï¼Œå³4byteæ¥è¡¨ç¤ºçš„ã€‚è¿™æ ·UTF-16å°±èƒ½ç¼–ç å‡º65436+2500ä¸ªå­—ç¬¦ï¼Œå‰65436ä¸ªå­—ç¬¦éƒ½æ˜¯2 byteè¡¨ç¤ºï¼Œå2500ä¸ªéƒ½æ˜¯4 byteè¡¨ç¤ºã€‚

ä¸Šé¢åªæ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå®é™…ä¸ŠUnicodeé™¤äº†BMPï¼Œè¿˜æœ‰16å—é¢æ¿ï¼Œæ¯å—é¢æ¿0xFFFFä¸ªç ç‚¹ï¼Œæ‰€ä»¥é™¤äº†BMPä¸€å…±è¿˜æœ‰0xFFFFFä¸ªç ç‚¹éœ€è¦ç¼–ç ï¼Œå³2^20ï¼Œ`2^10 * 2*10`ä¸ªã€‚

æ‰€ä»¥UTF-16çš„ä¸¤å­—èŠ‚ç©ºé—´ä¸­ï¼Œå…±è®¡`2^10 + 2^10`ä¸ªç ç‚¹ä¸ç¼–ç å­—ç¬¦ï¼Œå°±å¯ä»¥ç»„åˆåé¢éœ€è¦çš„`2^10 * 2*10`ä¸ªç ç‚¹ã€‚**æ‰€ä»¥UTF-16æ²¡æœ‰ä½¿ç”¨2byteç¼–ç BMPä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼Œè€Œæ˜¯é¢„ç•™äº†`0x3FF + 0x3FF = 0x6FF`ä¸ªç ç‚¹ä¸ç¼–ç å­—ç¬¦**ï¼Œä½¿ç”¨è¿™0x6FFä¸ªï¼ˆ2048ä¸ªï¼‰ç ç‚¹ï¼Œå‰åä¸¤ä¸¤ç»„åˆå‡ºäº†åé¢16ä¸ªé¢æ¿æ‰€éœ€è¦çš„0xFFFFFä¸ªï¼ˆ1024 * 1024ä¸ªï¼‰ç ç‚¹ã€‚

è¿™ä¸¤ä¸ª0x3FFç©ºé—´çš„ç ç‚¹ï¼ŒUTF-16é€‰çš„æ˜¯`0xD800-0xDBFF`å’Œ`0xDC00-0xDFFF`ã€‚

> BMPçš„å­—ç¬¦éƒ½æ˜¯2 byteè¡¨ç¤ºï¼Œsupplementary planeçš„å­—ç¬¦éƒ½æ˜¯4 byteè¡¨ç¤ºã€‚

å»¶ä¼¸é˜…è¯»ï¼š
- https://stackoverflow.com/a/47505451/7676237

### BMPä¸­çš„ä»£ç†åŒºåŸŸ
ç”±äºè¿™ç‰¹æ®Šçš„ä¸¤å—ç©ºé—´çš„ç ç‚¹è¢«ç”¨æ¥ç»„åˆå‡ºåé¢16å—é¢æ¿çš„ç ç‚¹ï¼Œæ‰€ä»¥ä¹Ÿè¢«ç§°ä¸ºä»£ç†ç ç‚¹ï¼ˆSurrogate code pointï¼‰ï¼Œ`0xD800-0xDBFF`å’Œ`0xDC00-0xDFFF`åˆ†åˆ«è¢«ç§°ä¸ºHigh-Surrogateå’ŒLow-Surrogateã€‚

> `0xD800-0xDBFF`çš„å‰6bitæ˜¯`110110`ï¼Œ`0xDC00-0xDFFF`çš„å‰6bitæ˜¯110111ï¼Œæ‰€ä»¥supplementary planeçš„å››å­—èŠ‚è¡¨ç¤ºå›ºå®šä¸ºï¼š`110110** ******** 110111** ********`

æ˜¾ç„¶ï¼Œ**ä»£ç†åŒºåŸŸæ˜¯ä¸ä¼šè¢«ç¼–ç ä¸Šå­—ç¬¦çš„**ï¼è¦ä¸ç„¶å‡ºç°äº†ä»£ç†åŒºåŸŸçš„ç ç‚¹ï¼Œç©¶ç«Ÿæ˜¯ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œè¿˜æ˜¯æ‹¿å®ƒå»å’Œåé¢çš„ç ç‚¹å»ç»„åˆå‡ºä¸€ä¸ªä»£ç†å­—ç¬¦ï¼Ÿ**æ‰€ä»¥BMPçš„65536ä¸ªç ç‚¹å¹¶ä¸èƒ½è¡¨ç¤º65536ä¸ªå­—ç¬¦**ã€‚

å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹Unicodeåœ¨BMPçš„ç ç‚¹ `0xD800-0xDFFF`ï¼Œè¿™ä¸€å—ç¡®å®æ²¡æœ‰ç¼–ç ä»»ä½•å­—ç¬¦ï¼šhttps://en.wikibooks.org/wiki/Unicode/Character_reference/D000-DFFF

å‚é˜…ï¼š
- https://en.wikipedia.org/wiki/UTF-16
- https://en.wikipedia.org/wiki/Universal_Coded_Character_Set

### ä¸ºä»€ä¹ˆUnicodeä¸­ä¼šæœ‰ä»£ç†åŒºåŸŸçš„æ¦‚å¿µ
ç†è®ºä¸Šæ¥è®²ï¼Œä»£ç†åŒºåŸŸè¿™ä¸€æ¦‚å¿µä»…å¯¹UTF-16å­—ç¬¦é›†æœ‰æ•ˆã€‚**Unicodeä¸­ä¸è¯¥æœ‰ä»£ç†åŒºåŸŸçš„æ¦‚å¿µï¼Œå®ƒå®Œå…¨å¯ä»¥åœ¨ä¸Šé¢ç¼–ç ä¸Šå­—ç¬¦ã€‚ä½†æ˜¯è¿™æ ·å¯¹UTF-16æ¥è®²ä¼¼ä¹ä¸å¤ªå‹å¥½ï¼Œå› ä¸ºåœ¨ä½¿ç”¨UTF-16çš„æ—¶å€™ï¼Œé¢å¯¹å››ä¸ªå­—èŠ‚ï¼Œå®ƒå¯ä»¥è¢«è§£é‡Šä¸º**ï¼š
1. ä¸¤ä¸ªBMPçš„å­—ç¬¦ï¼›
2. ä¸€ä¸ªè¡¥å……é¢æ¿çš„å­—ç¬¦ï¼›

ä½†æ˜¯å¦‚æœUnicodeä¸åœ¨UTF-16ç”¨åˆ°çš„ä»£ç†åŒºåŸŸç¼–ç å­—ç¬¦ï¼Œå°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œä¸€çœ‹åˆ°è¿™ä¸ªåŒºåŸŸçš„ç ç‚¹ï¼Œå°±ä¼šå‘ç°ä¸€ä¸ªç ç‚¹è¡¨ç¤ºä¸å‡ºå­—ç¬¦ï¼Œå¿…é¡»æ˜¯ä¸¤ä¸ªä¸€èµ·è¡¨ç¤ºä¸€ä¸ªè¡¥å……é¢æ¿ä¸Šçš„å­—ç¬¦ã€‚

æ„Ÿè§‰è¿™æ˜¯Unicodeè¿™ä¸ªè§„èŒƒï¼ˆæ¥å£ï¼‰ä¸ºäº†å®ƒçš„å®ç°ä¹‹ä¸€UTF-16è€Œæ•…æ„ä¸ç»™è¿™ä¸€æ®µåŒºåŸŸç¼–ç å­—ç¬¦ï¼æ‰€ä»¥å­¦ä¹ Unicodeçš„æ—¶å€™ï¼Œåè€Œç»•ä¸è¿‡å®ƒçš„è¿™ä¸ªå®ç°ï¼Œå¦åˆ™å°±è§£é‡Šä¸äº†è¿™ä¸€å—ä¸ºä»€ä¹ˆä¸ç¼–ç å­—ç¬¦ï¼ä¹ŸæŒºè¿·çš„ã€‚åªèƒ½è¯´ï¼Œå½“å¹´ä»¥ä¸º2byteèƒ½è¡¨ç¤ºæ‰€æœ‰å­—ç¬¦çš„å¤©çœŸæƒ³æ³•ï¼Œå¯¼è‡´äº†è¿™ä¸€ç³»åˆ—ä¸ä¼˜é›…çš„è®¾è®¡ã€‚

### å­—èŠ‚åºé—®é¢˜ï¼š0xFEFF
**UTF-16ä½¿ç”¨åŒå­—èŠ‚ï¼ˆ16bitï¼‰ä½œä¸ºä¸€ä¸ªunitï¼Œæ‰€ä»¥å­˜åœ¨å­—èŠ‚åºé—®é¢˜**ï¼šä¸€ä¸ªunitçš„ä¸¤ä¸ªå­—èŠ‚ï¼Œè°æ”¾å‰é¢è°æ”¾åé¢ï¼Ÿ

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒUTF-16ç¼–ç çš„æ–‡ä»¶çš„å‰ä¸¤ä¸ªå­—èŠ‚ä½¿ç”¨**å­—èŠ‚åºæ ‡è®°ï¼ˆByte Order Markï¼ŒBOMï¼‰** æŒ‡å®šå­—èŠ‚åºã€‚å¯¹äºUTF-16æ¥è¯´ï¼Œè¿™ä¸ªBOMå°±æ˜¯`0xFEFF`ï¼š
- å¦‚æœå¤´ä¸¤ä¸ªå­—èŠ‚æ˜¯`0xFE`å’Œ`0xFF`ï¼Œåˆ™é‡‡ç”¨å¤§ç«¯åºï¼ˆBig-Endianï¼‰ï¼Œæ­¤æ—¶çš„å­—ç¬¦é›†åˆè¢«ç§°ä¸º **`UTF-16BE`** ã€‚eg: å¯¹äºä¸¤ä¸ªå­—èŠ‚`0x12345678`ï¼Œå¤§ç«¯åºæ˜¯`0x1234`åé¢è·Ÿç€`0x5678`ï¼›
- å¦‚æœå¤´ä¸¤ä¸ªå­—èŠ‚æ˜¯`0xFF`å’Œ`0xFE`ï¼Œåˆ™é‡‡ç”¨å°ç«¯åºï¼ˆLittle-Endianï¼‰ï¼Œæ­¤æ—¶çš„å­—ç¬¦é›†åˆè¢«ç§°ä¸º **`UTF-16LE`** ã€‚eg: å¯¹äºä¸¤ä¸ªå­—èŠ‚`0x12345678`ï¼Œå¤§ç«¯åºæ˜¯`0x5678`åé¢è·Ÿç€`0x1234`ï¼›

å¦å¤–å€¼å¾—æ³¨æ„çš„å°±æ˜¯UTF-8ä¸éœ€è¦å­—èŠ‚åºæŒ‡ç¤ºï¼Œæ‰€ä»¥ä¸€æ—¦å‡ºç°0xFEFFæˆ–è€…0xFFFEï¼Œè¯´æ˜è¿™ä¸æ˜¯UTF-8ç¼–ç çš„æ–‡ä»¶ã€‚ï¼ˆå¯èƒ½æ˜¯UTF-16ï¼Œä¹Ÿå¯èƒ½æ˜¯UTF-32ï¼‰

å‚é˜…ï¼š
- https://en.wikipedia.org/wiki/Byte_order_mark
- http://www.fileformat.info/info/charset/UTF-16/list.htm

## UTF-32: use 32-bit code unit
UTF-32ä½¿ç”¨32bitï¼ˆ4 byteï¼‰ä½œä¸ºä¸€ä¸ªç¼–ç çš„åŸºæœ¬å•å…ƒã€‚æ˜¾ç„¶UTF-16å°±æ˜¯**å®šé•¿ç¼–ç **äº†ï¼Œå› ä¸ºå°±ç®—æŒ‰å®šé•¿å»ç¼–ç ï¼Œ2^32^ä¾ç„¶èƒ½è¡¨ç¤ºå‡ºUnicodeå½“å‰æ€»å…±2^21^çš„ç¼–ç ç©ºé—´ã€‚

è¯šç„¶ï¼Œä½¿ç”¨UTF-32å­˜å‚¨å­—ç¬¦æ˜¯éå¸¸è´¹ç©ºé—´çš„ï¼Œå‡ ä¹æ˜¯UTF-16çš„2å€ï¼Œå¦‚æœå­˜å‚¨è‹±æ–‡ï¼Œå ç”¨ç©ºé—´æ˜¯UTF-8çš„4å€ã€‚ä½†æ˜¯UTF-32æœ‰éå¸¸å¹¿é˜”çš„åº”ç”¨ç©ºé—´ï¼Œæ¯”å¦‚ï¼Œæƒ³çŸ¥é“ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ç¬¬Nä¸ªå­—ç¬¦çš„å†…å®¹ï¼Œç›´æ¥æŸ¥çœ‹ç¬¬4N~4N+3è¿™å››ä¸ªå­—èŠ‚å¯¹åº”å“ªä¸ªå­—ç¬¦å°±è¡Œäº†ï¼Œæ‰€ç”¨æ—¶é—´æ˜¯**å¸¸é‡çº§**çš„ã€‚ä½†æ˜¯å˜é•¿ç¼–ç å°±å¿…é¡»ä»å¤´éå†æ‰èƒ½åˆ¤æ–­ç¬¬Nä¸ªå­—ç¬¦çš„å†…å®¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚

> ä½†æ˜¯ç”±äºç»„åˆå­—ç¬¦çš„å­˜åœ¨ï¼ˆä¸¤ä¸ªUnicodeç ç‚¹ç»„åˆå‡ºä¸€ä¸ªå­—ç¬¦ï¼‰ï¼ŒUTF-32çš„å®šé•¿ä¹Ÿå¹¶ä¸èƒ½è¯´ä¸€ä¸ªå­—ç¬¦ä¸€å®šæ˜¯4byteâ€¦â€¦æ‰€ä»¥ä¹Ÿä¸èƒ½è¯´UTF-32å°±ä¸€å®šèƒ½åœ¨å¸¸é‡æ—¶é—´å¯¹UTF-32ç¼–ç çš„å­—ç¬¦è¿›è¡Œè®¡æ•°ï¼Œåªèƒ½å¯¹ç ç‚¹è¿›è¡Œè®¡æ•°ã€‚è¿™æ˜¯Unicodeçš„å®šä¹‰å¯¼è‡´çš„ï¼ˆç ç‚¹å’Œå­—ç¬¦å¹¶ä¸ä¸€ä¸€å¯¹åº”ï¼‰ã€‚

### å­—èŠ‚åºé—®é¢˜
**å’ŒUTF-16ä¸€æ ·ï¼ŒUTF-32çš„åŸºæœ¬å•å…ƒï¼ˆ4 byteï¼‰ä¹Ÿæ˜¯è·¨å­—èŠ‚çš„ï¼Œæ‰€ä»¥ä¹Ÿä¼šå­˜åœ¨å­—èŠ‚åºé—®é¢˜**ã€‚ä½¿ç”¨BOM `0x 00 00 FE FF`å’Œ`0x FF FE 00 00`æ ‡å¿—ã€‚

# å­—ç¬¦é›†æ¯”è¾ƒ
## å…¼å®¹æ€§
UTF-8å¯ä»¥å’ŒASCIIå…¼å®¹ï¼ŒUTF-16/32åˆ™ä¸å¯ä»¥ã€‚

## å­˜å‚¨æ•ˆç‡
- UTF-8å­˜å‚¨å‰128ä¸ªå­—ç¬¦ä½¿ç”¨1 byteï¼Œåç»­çš„BMPç ç‚¹åˆ†åˆ«æ˜¯2 byteï¼Œ3byteï¼Œsupplementary planeæ˜¯4 byteï¼›
- UTF-16åœ¨BMPä¸Šæ’ä¸º2 byteï¼Œsupplementary planeæ˜¯4 byteï¼›
- UTF-32æ’ä¸º4 byteï¼›

æ‰€ä»¥UTF-8åœ¨å­˜å‚¨è‹±æ–‡çš„æ—¶å€™æ›´é«˜æ•ˆï¼Œå…¶ä»–å­—ç¬¦æ¯”å¦‚CJKåˆ™ä¸å¦‚UTF-16ã€‚UTF-32é»¯ç„¶é€€å‡ºã€‚

ä½†æ˜¯è¿™å¹¶ä¸æ„å‘³ç€ä¸­å›½ä½¿ç”¨UTF-16ç¼–ç ç½‘é¡µä¼šè·å¾—æ›´é«˜çš„æ€§èƒ½ï¼šä»…ä»…çº¯æ–‡å­—ä¼šã€‚ä½†æ˜¯ç½‘é¡µè¿˜æœ‰å¾ˆå¤štagä¹‹ç±»çš„ä¸œè¥¿ï¼Œä½¿ç”¨ASCIIå­—ç¬¦ï¼Œæ‰€ä»¥æ•´ä½“ä¸Šï¼Œå°±ç®—æ˜¯ä¸­æ–‡çš„ç½‘é¡µï¼Œä½¿ç”¨UTF-8ä¹Ÿä¸ä¸€å®šæ¯”UTF-16æ›´æ¶ˆè€—ç©ºé—´ã€‚

## ä¼˜åŠ£
å„ç§å­—ç¬¦ç¼–ç æ–¹å¼ç¡®æœ‰ä¼˜åŠ£ä¹‹åˆ†ï¼š
- UTF-32ä½œä¸ºå”¯ä¸€å®šé•¿ç¼–ç ï¼Œæ˜¯æœ‰å­˜åœ¨çš„å¿…è¦çš„ï¼›
- UTF-8ä½œä¸ºé«˜æ•ˆä¸”å…¼å®¹ASCIIçš„å˜é•¿ç¼–ç ï¼Œæ˜¯å½“ä»Šçš„ä¸»æµå­—ç¬¦é›†ã€‚å…·ä½“å‚è€ƒ[UTF-8 everywhere](http://utf8everywhere.org/)ï¼
- **UTF-16æ˜¯å†å²åŸå› å¯¼è‡´çš„ç•¥æ˜¾ç•¸å½¢çš„å­—ç¬¦é›†ï¼Œä¸åº”å†è¢«æ–°ç³»ç»Ÿä½¿ç”¨**ï¼›

# å…¶ä»–

## ç ç‚¹å’Œå­—ç¬¦çš„å¯¹åº”å…³ç³»
æœ€åè¯´ä¸€ä¸‹ï¼Œä»¥ä¸Šä¸ºäº†ç†è§£æ–¹ä¾¿ï¼Œå§‘ä¸”è®¤ä¸ºUnicodeç ç‚¹å’Œå­—ç¬¦æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚**ä½†å®é™…ä¸Šå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç ç‚¹å’Œå­—ç¬¦éƒ½æ˜¯ä¸€ä¸€å¯¹åº”çš„**ï¼š
- æœ‰çš„ç ç‚¹ä¸å¯¹åº”å­—ç¬¦ï¼Œæ¯”å¦‚ä»£ç†åŒºç ç‚¹ã€æœªç¼–ç å­—ç¬¦ç ç‚¹ï¼›
- å¤šä¸ªç ç‚¹å¯èƒ½ä»£è¡¨åŒä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚Î©ï¼š[0x03A9](http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=03a9&mode=hex)å’Œ[0x2126](http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=2126&mode=hex)ï¼›
- **è¿˜æœ‰ä¸€äº›å­—ç¬¦æ˜¯ä¸¤ç§å­—ç¬¦ç»„åˆå‡ºæ¥çš„ï¼Œæ‰€ä»¥è¿™æ ·çš„ä¸€ä¸ªå­—ç¬¦æ˜¯Unicodeçš„ä¸¤ä¸ªç ç‚¹ç»„åˆèµ·æ¥è¡¨ç¤ºçš„**ï¼›
- ä¸Šä¾‹ä¹Ÿè¯´æ˜äº†ï¼Œæœ‰çš„å­—ç¬¦å¹¶ä¸å­˜åœ¨ä¸€ä¸ªèƒ½ä»£è¡¨å®ƒçš„ç ç‚¹ï¼›

æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼š**å­—ç¬¦å’Œç ç‚¹å¹¶æ²¡æœ‰ä»€ä¹ˆå…³ç³»ã€‚åªæ˜¯ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå­—ç¬¦å’Œç ç‚¹æ˜¯ä¸€ä¸€å¯¹åº”çš„**ã€‚æ‰€ä»¥è®¤ä¸ºä»–ä»¬ä¸€ä¸€å¯¹åº”å…¶å®æ¯”è¾ƒä¾¿äºç†è§£Unicodeå’Œå­—ç¬¦ç¼–ç çš„å…³ç³»ã€‚

## NFC: Normalization Form C
`cafÃ©`ç®—å‡ ä¸ªå­—ç¬¦ï¼Ÿæˆ–è€…è¯´å‡ ä¸ªç ç‚¹ï¼Ÿä¸»è¦æ¶‰åŠåˆ°`Ã©`ï¼Œå®ƒå¯ä»¥æ˜¯[å­—æ¯eï¼ˆU+0065ï¼‰](http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=e&mode=char)å’Œ[é‡éŸ³ç¬¦å·Â´ï¼ˆU+00B4ï¼‰](http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=%C2%B4&mode=char)ç»„åˆå‡ºæ¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯[ä¸€ä¸ªå•å­—ç¬¦Ã©ï¼ˆU+00E9ï¼‰](http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=00e9&mode=hex)ã€‚æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¹ˆç¥å¥‡â€¦â€¦

å¯¹äºç»„åˆæƒ…å†µï¼Œ`cafÃ©`æ€»å…±æœ‰5ä¸ªç ç‚¹ï¼ŒUTF-8è¡¨ç¤ºå…±æœ‰6ä¸ªå­—èŠ‚0x63 0x61 0x66 0x65 0xCC 0x81ï¼›å¯¹äºéç»„åˆæƒ…å†µï¼Œå…±æœ‰4ä¸ªç ç‚¹ï¼Œ5ä¸ªå­—èŠ‚0x63 0x61 0x66 0xC3 0xA9ã€‚

æ‰€ä»¥å…·ä½“æ˜¯å“ªä¸€ç§æƒ…å†µï¼Œéœ€è¦çœ‹ç”¨çš„æ˜¯Unicodeçš„å“ªä¸€ç§è§„èŒƒåŒ–å½¢å¼ã€‚å…¶ä¸­**NFCï¼ˆNormalization Form Cï¼Œæ ‡å‡†åŒ–å½¢å¼Cï¼‰è§„å®šï¼Œç¢°åˆ°`Ã©`è¿™ç§å­—ç¬¦æ—¶ï¼Œå½“åš1ä¸ªç ç‚¹å¤„ç†**ã€‚

å‚é˜…ï¼š
- https://developer.twitter.com/en/docs/basics/counting-characters

# Java
å¯æ€œçš„Javaï¼Œå› ä¸ºå†å²åŸå› ï¼Œå¯¼è‡´ç°åœ¨å†…éƒ¨è¿˜ä½¿ç”¨UTF-16è¡¨ç¤ºå­—ç¬¦ä¸²â€¦â€¦

## char
åœ¨Javaä¸­ï¼Œä¸€ä¸ªcharæ˜¯2byteï¼Œä»£è¡¨UTF-16ä¸­çš„ä¸€ä¸ªç ç‚¹ã€‚**Javaä¸­çš„charå’Œç ç‚¹æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚æ‰€ä»¥charå¹¶ä¸å’Œå­—ç¬¦ä¸€ä¸€å¯¹åº”**ï¼Œåªæ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹ä¸€ä¸ªç ç‚¹ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹ä¸€ä¸ªcharä¸€ä¸ªå­—ç¬¦ã€‚

**ä¸€ä¸ªcharåªèƒ½è¡¨ç¤ºä¸€ä¸ªBMPä¸­ï¼ˆéä»£ç†åŒºåŸŸï¼‰çš„å­—ç¬¦ã€‚å¦‚æœæƒ³è¡¨ç¤ºè¡¥å……é¢æ¿çš„å­—ç¬¦ï¼Œè¦ç”¨ä¸¤ä¸ªchar**ï¼ä¸¤ä¸ªä»£ç†åŒºåŸŸçš„ç ç‚¹ç»„åˆå‡ºä¸€ä¸ªè¡¥å……é¢æ¿çš„å­—ç¬¦ã€‚

### è¡¨ç¤ºè¡¥å……é¢æ¿çš„å­—ç¬¦
**å¯¹äºUTF-16æ¥è¯´ï¼Œä¸€ä¸ªè¡¥å……ç¼–ç å­—ç¬¦çš„ç ç‚¹ï¼Œç­‰äºä¸¤ä¸ªä»£ç†åŒºåŸŸçš„ç ç‚¹çš„ç»„åˆã€‚**

æ‰€ä»¥æƒ³è¡¨ç¤º[emojiéœ²é½¿ç¬‘ï¼ŒU+1F600](http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=1F600&mode=hex)ï¼Œè¦ä¹ˆç›´æ¥ä½¿ç”¨ä¸¤ä¸ªä»£ç†å¯¹çš„ç ç‚¹ï¼š
```java
        // use surrogate pair
        String smile0 = "\uD83D\uDE00";
        System.out.printf("simle0: %s%n", smile0);
```
è¦ä¹ˆæŒ‡æ˜éœ²é½¿ç¬‘åœ¨è¡¥å……é¢æ¿çš„ç ç‚¹ï¼Œç„¶åä½¿ç”¨`StringBuilder#appendCodePoint`æˆ–è€…`Character#toCharså°†è¡¥å……é¢æ¿çš„ç ç‚¹**è½¬æ¢æˆä¸¤ä¸ªcharï¼ˆä¸¤ä¸ªä»£ç†åŒºåŸŸçš„ç ç‚¹ï¼‰ï¼Œæœ€ç»ˆåªèƒ½ä»¥Stringçš„å½¢å¼ä¿å­˜ï¼ˆå› ä¸ºä¸€ä¸ªcharä¿å­˜ä¸ä¸‹ï¼‰**ï¼š
```java
        int smileCodePoint = 0x1F600;
        
        // use StringBuilder code point
        String smile1 = new StringBuilder().appendCodePoint(smileCodePoint).toString();
        System.out.printf("simle1: %s%n", smile1);
        
        // use Character code point
        String smile2 = new String(Character.toChars(smileCodePoint));
        System.out.printf("simle2: %s%n", smile2);
```
ä½†æ— è®ºå¦‚ä½•ï¼Œè¦è¡¨ç¤ºå®ƒéƒ½å¿…é¡»ä½¿ç”¨ä¸¤ä¸ªcharï¼Œ4byteã€‚

æ‰€ä»¥è¯´`Character.toChars(int codePoint)`æ–¹æ³•å°†ç ç‚¹è½¬æˆcharï¼Œè¿”å›å€¼æ˜¯charæ•°ç»„è€Œä¸æ˜¯charï¼š
> Converts the specified character (Unicode code point) to its UTF-16 representation stored in a char array. If the specified code point is a BMP (Basic Multilingual Plane or Plane 0) value, the resulting char array has the same value as codePoint. If the specified code point is a supplementary code point, the resulting char array has the corresponding surrogate pair.

å‚é˜…ï¼š
- https://stackoverflow.com/questions/9834964/char-to-unicode-more-than-uffff-in-java

å› æ­¤å¯¹äºæ¥æ”¶charä½œä¸ºå‚æ•°çš„æ–¹æ³•ï¼Œå¦‚æœä¼ è¿›æ¥çš„å­—ç¬¦æ˜¯supplementary planeä¸Šçš„å­—ç¬¦ï¼Œå®é™…åªä¼ è¿›å»äº†ç¬¬ä¸€ä¸ªç ç‚¹ï¼ˆè¢«æˆªæ–­äº†ï¼‰ã€‚

## ä¸åŒè¯­è¨€ä¸­çš„char
- cè¯ç”Ÿçš„æ—¶å€™ï¼ŒASCIIçœ‹èµ·æ¥æ˜¯å¤Ÿçš„ã€‚æ‰€ä»¥**cçš„charç”¨1byteè¡¨ç¤º**ï¼›
- javaè¯ç”Ÿçš„æ—¶å€™ï¼ŒUCS-2ï¼Œ65536ï¼Œ2byteçœ‹èµ·æ¥æ˜¯å¤Ÿçš„ï¼Œæ‰€ä»¥**Javaçš„charç”¨äº†2byteè¡¨ç¤º**ï¼›

ç»“æœéƒ½ä¸å¤Ÿï¼Œç°åœ¨Unicodeå·²ç»æ‰©å……åˆ°17ä¸ªé¢æ¿äº†ã€‚è¯è¯´å›æ¥ï¼Œå¦‚æœç°åœ¨è®©æˆ‘è®¾è®¡ä¸€é—¨è¯­è¨€ï¼Œä¹Ÿè®¸æˆ‘å†…éƒ¨çš„charç”¨4byteè¡¨ç¤ºäº†å‘¢ã€‚ç„¶åNå¹´åï¼Œå¤–æ˜Ÿäººä¹Ÿæ¥äº†ï¼Œå½“æŠŠä»–ä»¬çš„è¯­è¨€ä¹Ÿç¼–è¿›æ¥çš„æ—¶å€™ï¼Œä»–ä»¬ä¼šè§‰å¾—4byteåˆä¸å¤Ÿè¡¨ç¤ºäº†ï¼Œä»–ä»¬è‚¯å®šä¼šé—®ï¼Œä¸ºä»€ä¹ˆæˆ‘çš„charä¸ç”¨8byteè¡¨ç¤ºâ€¦â€¦

Ref:
- https://stackoverflow.com/a/9354024/7676237

## `String`
ä»¥å‰ï¼ŒJavaçš„Stringçš„å†…éƒ¨å®ç°æ˜¯ä¸€ä¸ªcharæ•°ç»„ï¼š
```java
    /** The value is used for character storage. */
    private final char value[];
```
æ‰€ä»¥Stringä¹Ÿå¯ä»¥è¯´æ˜¯ç”¨UTF-16ç¼–ç å®ç°çš„ã€‚

ä½†æ˜¯java9å¼•å…¥äº†[Compact Strings](https://openjdk.org/jeps/254)ï¼Œå†…éƒ¨ç”¨byteæ•°ç»„è¡¨ç¤ºï¼Œå¹¶ç”¨ä¸€ä¸ªè¡¨ç¤ºä½è¡¨ç¤ºbyteæ•°ç»„ç”¨UTF-16è§£é‡Šè¿˜æ˜¯ç”¨LATIN1è§£é‡Šï¼š
```java
    /**
     * The value is used for character storage.
     *
     * @implNote This field is trusted by the VM, and is a subject to
     * constant folding if String instance is constant. Overwriting this
     * field after construction will cause problems.
     *
     * Additionally, it is marked with {@link Stable} to trust the contents
     * of the array. No other facility in JDK provides this functionality (yet).
     * {@link Stable} is safe here, because value is never null.
     */
    @Stable
    private final byte[] value;

    /**
     * The identifier of the encoding used to encode the bytes in
     * {@code value}. The supported values in this implementation are
     *
     * LATIN1
     * UTF16
     *
     * @implNote This field is trusted by the VM, and is a subject to
     * constant folding if String instance is constant. Overwriting this
     * field after construction will cause problems.
     */
    private final byte coder;
```
å¦‚æœåªæœ‰ASCIIå­—ç¬¦é›†é‡Œçš„å­—ç¬¦å‡ºç°ï¼ŒStringå®é™…ä½¿ç”¨çš„å­—èŠ‚æ•°å’Œå­—ç¬¦æ•°æ¯”å€¼ä¸º1ï¼š1ï¼ŒUTF-16åˆ™è‡³å°‘æ˜¯2ï¼š1ã€‚

æ‰€ä»¥compact stringä¼˜åŒ–äº†Java Stringçš„å†…éƒ¨ç©ºé—´å ç”¨ã€‚ä½†æ˜¯ï¼Œ**è™½ç„¶å®ç°ä¸Šä¸å†ç”¨charæ•°ç»„è¡¨ç¤ºäº†ï¼Œä½†ä¸å½±å“é€»è¾‘ä¸Šç”¨åˆ°çš„charçš„ä¸ªæ•°**ã€‚

### `string.lentgh()`
å®˜æ–¹æ–‡æ¡£è¯´Stringçš„lengthæ–¹æ³•è¿”å›çš„æ˜¯**Unicode code unitsçš„ä¸ªæ•°**ï¼š
> Returns the length of this string. The length is equal to the number of Unicode code units in the string.

ç”±äºcharå’Œcode unitä¸€ä¸€å¯¹åº”ï¼Œæ‰€ä»¥å…¶å®è¿”å›çš„å°±æ˜¯charæ•°ç»„ä¸­charçš„ä¸ªæ•°ï¼š
```java
    implements java.io.Serializable, Comparable<String>, CharSequence {
    /** The value is used for character storage. */
    private final char value[];
    
    /**
     * Returns the length of this string.
     * The length is equal to the number of <a href="Character.html#unicode">Unicode
     * code units</a> in the string.
     *
     * @return  the length of the sequence of characters represented by this
     *          object.
     */
    public int length() {
        return value.length;
    }
```
å¯¹äºjava9ï¼Œåªæ˜¯å†…éƒ¨å­˜å‚¨æ–¹å¼ä¸åŒï¼Œè™½ç„¶å®ç°ä¸Šä¸å†ç”¨charæ•°ç»„è¡¨ç¤ºäº†ï¼Œä½†ä¸å½±å“é€»è¾‘ä¸Šç”¨åˆ°çš„charçš„ä¸ªæ•°ï¼Œå› æ­¤å¹¶ä¸å½±å“æ¥å£æœ¬èº«ï¼šlengthè¿”å›çš„ä¾æ—§æ˜¯charçš„ä¸ªæ•°ã€‚åªä¸è¿‡ç°åœ¨è®¡ç®—æœ‰å¤šå°‘ä¸ªcharçš„æ—¶å€™ä¸åƒåŸæ¥ç›´æ¥è·å–`value.length`é‚£ä¹ˆç®€å•äº†ï¼Œè¦åˆ†æƒ…å†µè®¨è®ºäº†ï¼š
```java

    /**
     * Returns the length of this string.
     * The length is equal to the number of <a href="Character.html#unicode">Unicode
     * code units</a> in the string.
     *
     * @return  the length of the sequence of characters represented by this
     *          object.
     */
    public int length() {
        return value.length >> coder();
    }
```
- å¦‚æœçš„ç¡®æ˜¯ç´§å‡‘å­—ç¬¦ä¸²ï¼Œbyteæ•°ç»„çš„é•¿åº¦å°±æ˜¯charçš„é•¿åº¦ï¼š`value.length >> 0`ï¼›
- å¦‚æœä¸æ˜¯ç´§å‡‘å­—ç¬¦ä¸²ï¼Œbyteæ•°ç»„çš„é•¿åº¦æ˜¯charé•¿åº¦çš„äºŒå€ï¼š`value.length >> 1`ï¼›

å…·ä½“è€Œè¨€ï¼Œè¡¥å……é¢æ¿çš„å­—ç¬¦éƒ½éœ€è¦ä¸¤ä¸ªcharæ¥è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªcode unitï¼Œæ‰€ä»¥**ä»–ä»¬æ¯ä¸ªå­—ç¬¦çš„lengthå°±æ˜¯2**ï¼š
```java
        // ä¸€ä¸ªåƒâ€œå†¬â€ä½†ä¸æ˜¯â€œå†¬â€çš„æ–‡å­—
        int notDongCodePoint = 0x2F81A;
        String notDong = new String(Character.toChars(notDongCodePoint));
        String dong = "å†¬";
        // length is 2
        System.out.printf("%s.length = %d, by code point. %n", notDong, notDong.length());
        // length is 1
        System.out.printf("%s.length = %d, by CJK word. %n", dong, dong.length());
```
æ‰€ä»¥â€œå†¬â€ä½œä¸ºBMPå­—ç¬¦ï¼Œlength=1ï¼›è¡¥å……é¢æ¿ä¸­çš„é‚£ä¸ª[åƒå†¬è€Œä¸æ˜¯å†¬çš„å­—ç¬¦](http://www.ltg.ed.ac.uk/~richard/utf-8.cgi?input=2F81A&mode=hex)ï¼Œlength=2ã€‚

emojiåœ¨javaé‡Œçš„lengthä¹Ÿéƒ½æ˜¯2ã€‚
> ä½†æ˜¯åœ¨Elasticsearchä¸­ï¼Œä¸€ä¸ª Emoji è¡¨æƒ…ç¬¦å·çš„é•¿åº¦è¢«è§†ä¸ºä¸€ä¸ªå­—ç¬¦ã€‚è¿™æ˜¯å› ä¸º **Elasticsearch é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„ Unicode Tokenizer ï¼ˆä¹Ÿå°±æ˜¯[Standard Tokenizer](https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-tokenizer.html)ï¼‰ä¼šå°†è¡¨æƒ…ç¬¦å·è§†ä¸ºå•ä¸ªå­—ç¬¦è¿›è¡Œåˆ†è¯å’Œå¤„ç†**ã€‚æ‰€ä»¥å¦‚æœä½¿ç”¨Javaç»™å¸¦emojiçš„stringåšæˆªæ–­ï¼Œæˆªæ–­çš„ä½ç½®å’Œelasticsearchä¸ä¸€æ ·ã€‚

### éå†`String`
é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šéå†char arrayæ¥éå†stringï¼š
```java
for (char c : s.toCharArray()) {
    ...
}
```
**ä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸ªæ˜¯é€charéå†ï¼Œè€Œä¸æ˜¯é€å­—ç¬¦éå†**ã€‚å¦‚æœç¢°åˆ°è¡¥å……é¢æ¿çš„å­—ç¬¦ï¼Œæ¯æ¬¡åªæ‹¿åˆ°ä¸€ä¸ªcharï¼Œå°±å¯èƒ½æ‹¿åˆ°çš„ä¸æ˜¯ä¸€ä¸ªå®Œæ•´å­—ç¬¦ã€‚è€Œç°åœ¨emojiå·²ç»å¾ˆå¸¸è§äº†ï¼Œéå†ä»–ä»¬å°±å¯èƒ½å‡ºç°é—®é¢˜ã€‚

å‡è®¾`s = "ğŸ˜‹helloğŸ˜‹"`

è¿™æ ·éå†è¾“å‡ºï¼Œä¼šå¯¼è‡´åªæ‹¿åˆ°â€œåŠä¸ªemojiâ€ï¼š
```java
// è¾“å‡ºchar+\nï¼Œè§£é‡Šä¸å‡ºæ¥ï¼Œæ˜¾ç¤ºä¸º`?`
for (char c : s.toCharArray()) {
    System.out.println(c);
}
```
åŠä¸ªemojiåé¢åŠ ä¸Š`\n`ï¼Œè¾“å‡ºç»“æœå°±æ— æ³•è§£é‡Šäº†ï¼š
```
?
?
h
e
l
l
o
?
?
```
é™¤éè¿èµ·æ¥è¾“å‡ºï¼Œè¿™æ ·è™½ç„¶æ¯æ¬¡éƒ½åªè¾“å‡ºåŠä¸ªemojiï¼Œä½†æ˜¯å› ä¸ºæŒ¨ç€ï¼Œå°±èƒ½è¢«consoleè§£é‡Šä¸ºä¸€ä¸ªemojiï¼š
```java
// ä¸æ¢è¡Œçš„è¯å°±å¯ä»¥ï¼Œè®©ä¸¤ä¸ªcharè¿èµ·æ¥å°±èƒ½è¡¨ç¤ºemoji
for (char c : s.toCharArray()) {
    System.out.print(c);
}
```
ç»“æœä¸ºï¼š
```
ğŸ˜‹helloğŸ˜‹
```
å¦‚æœä¸æƒ³å› ä¸ºä¸åŒçš„è¾“å‡ºæ–¹å¼ä¸åŒè€Œå¯¼è‡´éå†å¤±è´¥ï¼Œéœ€è¦ä½¿ç”¨**é€å­—ç¬¦éå†**ï¼š
```java
s.codePoints().forEach(
        points -> System.out.println(Character.toChars(points))
);
```
æˆ–è€…ï¼š
```java
int offset = 0;
while (offset < s.length()) {
    int points = s.codePointAt(offset);
    System.out.println(Character.toChars(points));
    offset += Character.charCount(points);
}
```
è¿™æ ·æ— è®ºç”¨printè¿˜æ˜¯printlnï¼Œä¸€å®šéƒ½èƒ½æ­£ç¡®è¾“å…¥ï¼Œå› ä¸ºæ¯æ¬¡éƒ½æ‹¿ç€ä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦åœ¨æ“ä½œã€‚

> â€œåŸå­â€è¾“å‡ºã€‚

emojiå·²ç»å¾ˆå¸¸è§äº†ï¼Œä»¥åéå†å­—ç¬¦ä¸²è¦æ³¨æ„ï¼

å‚é˜…ï¼š
- http://reedbeta.com/blog/programmers-intro-to-unicode/#diversity-and-inherent-complexity
- https://github.com/puppylpg/java-examples/blob/master/src/main/java/example/unicode/CharacterDemo.java

# æ„Ÿæƒ³
æœ¬æ¥ä»¥ä¸ºä»…ä»…æ˜¯ç¨å¾®ç³»ç»Ÿäº†è§£ä¸€ä¸‹Unicodeï¼Œåº”è¯¥å¾ˆç®€å•çš„å°±æ€»ç»“å®Œäº†çš„ï¼Œæ²¡æƒ³åˆ°å°±ç®—å¿½è§†äº†è®¸å¤šç»†èŠ‚ï¼Œä¾æ—§æäº†ä¸¤ä¸‰å¤©â€¦â€¦å¥½å¤æ‚â€¦â€¦ä¸»è¦æ˜¯äº†è§£çš„è¶Šå¤šï¼Œç¢°åˆ°çš„ä¸è®¤è¯†çš„ä¸œè¥¿è¶Šå¤šã€‚å†å²é—ç•™é—®é¢˜å¯¹è®¾è®¡çš„æŸä¼¤å¤ªå¤§äº†â€¦â€¦

Orz

